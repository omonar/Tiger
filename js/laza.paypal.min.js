!function(t,a,e){"use strict";t.fn.paypal=function(n,o){if(!n)return this;if(!(o=t.extend({},t.fn.paypal.defaults,n.getRootProperty(J.SHOP),o)).id||!o.options||!o.currency){var i=[];return o.id||i.push("Seller ID"),o.options||i.push("Shop options"),o.currency||i.push("Currency"),console.log("paypal.js: Required parameter(s) "+i.join(", ")+" missing"),this}o.hasOwnProperty("handling")&&(o.handling=Math.abs("string"==typeof o.handling?parseFloat(o.handling):o.handling)),o.hasOwnProperty("discount")&&(o.discount=Math.min(Math.max(0,"string"==typeof o.discount?parseInt(o.discount):o.discount),99));var s,l,d,r,p,c,u,h,m,f,g,y,v,b,w,x,C,T,P,O,A,q,F=t(this).eq(0),I=F.data("lpp_ns"),S=t.fn.paypal.text,E=(o.id.replace("|","@"),codeToCurrency(o.currency)),R=codeToShortCurrency(o.currency),M=n.getAlbumTitle(),N=n.getAlbumRootPath(),_={cart:"shopping-cart",shortcut:"shopping-cart-shortcut",window:"cart-window",cont:"cont",summary:"summary",summaryTxt:"summary-txt",details:"details",newItems:"new-items",items:"items",pricing:"pricing",price:"price",itemTotal:"item-total",itemTotalAmount:"item-total-amount",reduction:"reduction",discountRate:"discount-rate",discountAmount:"discount-amount",total:"total",totalAmount:"total-amount",shipping:"shipping",shippingAmount:"shipping-amount",tax:"tax",taxAmount:"tax-amount",coupon:"coupon",redeem:"redeem",buttons:"buttons",item:"item",path:"path",file:"file",thumb:"thumb",title:"title",data:"data",options:"options",quantity:"quantity",discount:"discount",amount:"amount"},k={data:"paypal.cart.data",date:"paypal.cart.date",hash:"paypal.cart.hash",settingsHash:"paypal.cart.settingsHash",coupon:"paypal.cart.coupon"},L=DIR_PATH||"/",D=function(t,a){localStorage.setItem(L+t,a)},H=function(t){return localStorage.getItem(L+t)},U=function(t){localStorage.removeItem(L+t)},j="paypal.cart.voidCs",G=function(t){return R+" "+t.toFixed(2).replace(/(\d)(?=(\d{3})+\.)/g,"$1,")},B=function(){if(LOCALSTORAGE)for(var t in k)U(k[t])},W=function(){return JSON.stringify([o.id,o.currency,o.options]).hashCode()},Q=function(t){if(LOCALSTORAGE){var a,e,n=(new Date).getTime();if(e=H(k.date)){if(n-parseInt(e)>o.expiry)return void B();D(k.date,n)}if((e=H(k.data))&&H(k.hash)==e.hashCode()&&H(k.settingsHash)==W()){var i;for(a=JSON.parse(e),i=0;i<a.length;i++)K(c,a[i]);it(!0),i&&gt(H(k.coupon))}}ct(!0),at(),"function"==typeof t&&t.call(this)},$=function(a){var e,n={};if(a=a.split("="),n.name=t("<textarea>",{html:a[0]}).text(),a.length>1){if(e=a[1].split("+"),n.amount=parseFloat(e[0]),isNaN(n.amount))return null;e.length>1&&(n.shipping=parseFloat(e[1])||0,e.length>2?n.shipping2=parseFloat(e[2])||0:n.shipping2=n.shipping)}return n},V=function(t){var a=[];t=t.split("::");for(var e=0;e<t.length;++e)t[e]&&t[e].indexOf("=")>0&&a.push($(t[e]));return a},z=function(t){var a=t.find("."+_.options);return a.length?("SELECT"===a[0].nodeName?a=a.find("option:selected"):"FIELDSET"===a[0].nodeName&&(a=a.find("input:checked")),a.data("val")):(console.log("paypal.js: Can't find shop option!"),null)},Y=function(a,e,n,o,i){if(!a||!e)return{};var s=t("<input>",{type:o||"text"}).appendTo(a);return s.prop("name",e).addClass(e),n&&s.val("string"==typeof n?n.stripQuote():n),i&&s.prop(i,!0),s},K=function(a,n){if(r.find("."+_.item).length>=99)return e.modal(t("<div>",{html:S.noMoreItems}),{autoFade:3e3,class:"warning small"}),-1;var i,s,l=t("<form>",{name:_.item,class:_.item+" clearfix",method:"post"});if(l.on("submit",function(a){return a.preventDefault(),t(this).trigger("update"),!1}),(s=t("<a>",{class:"button icon-close"}).appendTo(l)).on("click."+I,function(){t(this).parents("form").eq(0).remove(),ct()}).on("selectstart",function(t){return t.preventDefault(),!1}),n.hasOwnProperty("path")&&n.hasOwnProperty("file")&&n.hasOwnProperty("title")&&n.hasOwnProperty("options")){Y(l,_.path,n.path,"hidden"),Y(l,_.file,n.file,"hidden"),function(a,e){var n;n=e.hasOwnProperty("path")?o.hasOwnProperty("relPath")?getRelativePath(o.relPath||"/",e.path):e.path:"",n+=o.thumbsFolder,e.hasOwnProperty("thumbFormat")?n+=e.file.replaceExt(e.thumbFormat):n+=e.file,a.append(t("<img>",{class:_.thumb,src:n})),a.append(t("<span>",{class:_.title,html:e.title}))}(l,n),s=function(a,e,n,i){var s=t(),l=function(t){return"radio"===o.selectMethod?t.name+"&nbsp;<small>"+R+"&nbsp;</small><b>"+t.amount.toFixed(2).replace(/(\d)(?=(\d{3})+\.)/g,"$1,")+"</b>"+(t.shipping?"&nbsp;(+"+t.shipping.toFixed(2)+")":""):t.name+" = "+G(t.amount)+(t.shipping?" (+"+t.shipping.toFixed(2)+")":"")};if("string"==typeof n&&(n=V(n)),Array.isArray(n)&&n.length>1){if("radio"===o.selectMethod){for(s=t("<fieldset>",{id:e,class:e}).appendTo(a),r=0;r<n.length;r++)d=n[r],s.append(t("<label>").append(t("<input>",{type:"radio",name:e,val:d.amount}).data("val",d)).append(l(d)));s.find("label").removeClass("checked"),s.find("input[type=radio]").eq(i||0).attr("checked","checked").closest("label").addClass("checked")}else{s=t("<select>",{name:e,class:e}).appendTo(a);for(var d,r=0;r<n.length;r++)d=n[r],s.append(t("<option>",{html:l(d),val:d.amount}).data("val",d))}s[0].selectedIndex=i||0}else Array.isArray(n)&&(n=n[0]),s=t("<span>",{class:e,html:l(n)}).data("val",n).appendTo(a);return s}(i=t("<div>",{class:_.data}).appendTo(l),_.options,n.options,n.selectedOption),"radio"===o.selectMethod&&(s=s.find("input[type=radio]")),s.on("change",function(){t(this).closest("form").trigger("update"),"radio"===o.selectMethod&&(t(this).closest("form").find("label").removeClass("checked"),t(this).closest("label").addClass("checked"))}),i.append("&times;");var d=n.hasOwnProperty("quantityCap")?n.quantityCap:o.quantityCap;if(s=Y(i,_.quantity,d?Math.min(d,n.quantity||1):n.quantity||1,"number"),n.hasOwnProperty("quantityCap")&&n.quantityCap>0&&s.data("quantityCap",n.quantityCap),!n.hasOwnProperty("quantityCap")&&1!==o.quantityCap||1!==n.quantityCap?s.on("change",function(){var a=t(this),n=t(this).data("quantityCap");typeof n===UNDEF&&(n=o.quantityCap),n>0&&parseInt(a.val())>n&&(e.modal(t("<div>",{html:S.maxNItems.replace("{0}",n)}),{autoFade:3e3,class:"warning small"}),a.val(n)),a.closest("form").trigger("update")}):s.prop("disabled","disabled"),n.hasOwnProperty("discountRate")&&n.discountRate>0&&n.discountRate<=99&&i.append(t("<span>",{class:_.discount,text:"-"+n.discountRate+"%"})),i.append("="),i.append(t("<span>",{class:_.amount})),l.on("update."+I,function(){ot(t(this)),ct()}),null!==ot(l))return a.append(l),l;console.log("paypal.js: Calculation error! Item skipped.")}else console.log('paypal.js: Can\'t add item. Required parameter "path", "title" or "options" missing.');return null},X=function(t){var a,e,o={},i=n.getPropertyObject(t,J.SHOP,!0);return i&&i.hasOwnProperty("options")&&"-"!==i.options&&(o={title:t[J.TITLE]||t[J.NAME]||"",path:n.getFolderPath(t),file:t[J.NAME],options:V(i.options)},a=t[J.THUMB][J.PATH].getExt(),t[J.NAME].getExt()!==a&&(o.thumbFormat=a),i.hasOwnProperty("discountRate")&&(e=parseInt(i.discountRate))>0&&e<100&&(o.discountRate=e),i.hasOwnProperty("tax")&&(e=parseFloat(i.tax))>0&&(o.tax=e),i.hasOwnProperty("quantityCap")&&(e=parseInt(i.quantityCap))>0&&(o.quantityCap=e)),o},Z=function(t){if(t){if(Array.isArray(t))if(t.length>1){nt();for(var a=0;a<t.length&&-1!==K(u,X(t[a]));a++);}else K(c,X(t[0]));else K(u,X(t));ct(),Pt()}},tt=function(){var a=0;return r.find("."+_.item).each(function(){a+=parseInt(t(this).find("."+_.quantity).val(),10)||1}),a},at=function(){var a=c.find("."+_.item),e=p.find("."+_.summaryTxt),n=a.length;if(e.empty(),n){for(var o=0;o<3&&!(o>=n);o++)e.append(t("<img>",{src:a.eq(o).find("img."+_.thumb).attr("src")}));n>3&&e.append(" +"+(n-3)+" "+S[n>4?"items":"item"]),c.hide(),p.show()}else p.hide()},et=function(){c.is(":hidden")&&(nt(),p.hide(),c.fadeIn(400,Tt))},nt=function(){u.find("."+_.item).each(function(){t(this).appendTo(c)}),u.empty().hide(),at()},ot=function(t){var a,e,n,o=z(t),i=1,s=0;return o&&o.amount?((e=t.find("."+_.quantity)).length&&(i=parseInt(e.val(),10)||1),n=o.amount*i,(e=t.find("."+_.discount)).length&&(a=Math.abs(parseFloat(e.text())))&&(n*=1-a/100),t.data("amount",n),o.shipping&&(s+=o.shipping),o.shipping2&&i>1&&(s+=(i-1)*o.shipping2),t.data("shipping",s),t.find("."+_.amount).html(G(n))):console.log("paypal.js: Calculation error!"),n},it=function(a){var e=h.data("val");return(a||typeof e===UNDEF)&&(e=function(){var a,e,n=0,o=0;return r.find("."+_.item).each(function(){typeof(a=t(this).data("amount"))===UNDEF&&(a=ot(t(this))),e=t(this).data("shipping"),n+=a,o+=e}),h.data("val",n),b.data("aggregate",o),n}()),e},st=function(){return y.data("val")||0},lt=function(t){if(f)if(typeof t!==UNDEF){var a=it()*t/100;y.data("val",t).text("-"+t+"%").toggle(t>0),v.data("val",a).html(G(a)),dt(t>0)}else g&&(g.val(""),LOCALSTORAGE&&U(k.coupon),s=null),y.data("val",0).empty().hide(),v.data("val",0).html(G(0)),dt(!1)},dt=function(t){f.find("."+_.data).toggle(typeof t===UNDEF||t)},rt=function(){if(o.hasOwnProperty("discount")&&o.discount>0&&o.discount<100){var t=0,a=0,e=it();if(y.data("val",o.discount).text("-"+o.discount+"%"),o.hasOwnProperty("discountMinQuantity")&&o.discountMinQuantity>0&&(v.data("qmin",o.discountMinQuantity),a=o.discountMinQuantity),o.hasOwnProperty("discountMinAmount")&&o.discountMinAmount>0&&(v.data("amin",o.discountMinAmount),t=o.discountMinAmount),a&&tt()<a||t&&e<t)y.hide(),v.data("val",0).html(G(0)),dt(!1);else{var n=e*o.discount/100;y.show(),v.data("val",n).html(G(n)),dt(n>0)}}else f&&(g&&(g.val(""),LOCALSTORAGE&&U(k.coupon),s=null),y&&y.data("val",0).empty().hide(),v.data("val",0).html(G(0)),dt(!1))},pt=function(t){if(f){var a=Math.min(it(),t);y&&y.data("val",0).empty().hide(),v.data("val",a).html(G(a)),dt(a>0)}},ct=function(a){var n=r.find("."+_.item).length;u.is(":empty")?(u.hide(),c.show(),p.hide()):(u.show(),c.hide(),p.toggle(!c.is(":empty"))),O.add(A).toggleClass("disabled",0===n),a&&!vt()&&rt(),function(a){var n=0,i=tt(),s=it(a),l=b.data("aggregate")||0,d=o.handling||0;m.html(G(s)),f&&((n=v.data("qmin"))&&n>i?(n=0,vt()?(e.modal(t("<div>",{html:S.couponRemoved+" "+S.addMoreItems.replace("{0}",n-i)}),{autoFade:3e3,class:"warning small"}),mt()):dt(!1)):(n=v.data("amin"))&&n>s?(n=0,vt()?(e.modal(t("<div>",{html:S.couponRemoved+" "+S.validAbove.replace("{0}",G(n))}),{autoFade:3e3,class:"warning small"}),mt()):dt(!1)):y&&(n=y.data("val"))&&n>0?(n=s*n/100,v.data("val",n).html(G(n)),dt(!0)):(n=v.data("val"))&&n>0?(y&&y.hide(),n>s?(e.modal(t("<div>",{html:S.couponRemoved+" "+S.amountLowerThan.replace("{0}",G(n))}),{autoFade:3e3,class:"warning small"}),n=0,mt()):dt()):dt(!1)),d||l>0?(b.show().data("val",Math.max(0,d+l)),w.html(G(d+l))):b.hide(),s+=d+l-n,C.data("netval",s),o.tax&&(P.html(G(s*o.tax/100)),s+=s*o.tax/100),C.html(E+" "+s.toFixed(2).replace(/(\d)(?=(\d{3})+\.)/g,"$1,"))}(!0),ut(n),a||function(a){if(LOCALSTORAGE){var e,n=[];l.find("."+_.item).each(function(){e=function(a){var e,n,i={};return(e=a.find("."+_.title)).length&&(i.title=e.text()),(e=a.find("."+_.path)).length&&(i.path=e.val()),(e=a.find("."+_.thumb).eq(0)).length&&(i.file=e.attr("src").getFile(),i.thumbFormat=e.attr("src").getExt()),(e=a.find("."+_.options).eq(0)).length&&("SELECT"===e[0].nodeName?(n=[],e.find("option").each(function(){n.push(t(this).data("val"))}),e[0].selectedIndex>0&&(i.selectedOption=e[0].selectedIndex)):"FIELDSET"===e[0].nodeName?(n=[],e.find("input[type=radio]").each(function(){n.push(t(this).data("val"))}),i.selectedOption=e.find("input[type=radio]").index(e.find("input:checked"))||0):n=e.data("val"),n!==o.options&&(i.options=n)),(e=a.find("."+_.discount)).length&&(i.discountRate=Math.abs(parseFloat(e.text()))),(e=a.find("."+_.quantity)).length&&(i.quantity=parseInt(e.val())||1,(n=e.data("quantityCap"))&&(i.quantityCap=n)),i}(t(this)),isEmpty(e)||n.push(e)}),n.length?(n=JSON.stringify(n),D(k.data,n),D(k.date,(new Date).getTime()),D(k.hash,n.hashCode()),D(k.settingsHash,W()),g&&(e=yt())?D(k.coupon,e):U(k.coupon)):B()}"function"==typeof a&&a.call(this)}()},ut=function(a){var e=q.find(".view-cart");if(e.length)if(a){var n=e.children(".badge");n.length||(n=t("<span>",{class:"badge"}).appendTo(e)),n.text(a).show()}else e.children(".badge").hide()},ht=function(){g&&(s&&s.hasOwnProperty("code")?g.val(s.code):g.val(""))},mt=function(){g&&(g.val(""),s={},rt())},ft=function(){var t;g&&(t=yt())?((s={}).code=t,(t=y.data("val"))&&(s.rate=t),(t=v.data("val"))&&(s.amount=t),(t=v.data("qmin"))&&(s.qmin=t),(t=v.data("amin"))&&(s.amin=t)):s=null},gt=function(t){t&&t.length&&g&&(g.val(t),wt(!1))},yt=function(){return g?g.val().trim():""},vt=function(){return g&&g.val().trim().length>0},bt=function(t){if(LOCALSTORAGE){var a=H(j);return a&&(t==a||a.indexOf("::")&&a.match(new RegExp("^"+t+"::|::"+t+"::|::"+t+"$")))}return!1},wt=function(a){var n;if(g&&(n=yt())){if(s&&s.hasOwnProperty("code")&&s.code===n)return!0;for(var i,l,d,r,p,c,u=new Date,h=it(),m=tt(),f=xDecrypt(o.coupons).split("::"),y=function(t){var a=t.split(/-|:|\//);return a.length<2&&(a[1]=1),a.length<3&&(a[2]=1),new Date(parseInt(a[0]),parseInt(a[1]),parseInt(a[2]))},b=0;b<f.length;b++)if((i=f[b].split(/=|\s/))[0]===n&&i.length>1){if("NaN"==typeof(l=parseFloat(i[1]))||l<.01)continue;d="%"===i[1].charAt(i[1].length-1),r=0,p=0,c=0;for(var w=2;w<i.length;w++)i[w].match(/<\d+([-|\:|\/]\d+[-|\:|\/]\d+[-|\:|\/])*/)?r=y(i[w].substring(1)):i[w].match(/\d+\.\d+\+/)?c=parseFloat(i[w]):i[w].match(/\d+\+/)&&(p=parseInt(i[w],10)||0);if(r&&r<u)a?e.modal(t("<div>",{html:S.expired.replace("{0}",n)}),{autoFade:3e3,class:"alert small"}):console.log('Coupon "'+n+'" has expired!'),ht();else if(c&&h<c)a?e.modal(t("<div>",{html:S.minAmountWarning.replace("{0}",G(c))}),{autoFade:3e3,class:"warning small"}):console.log('Coupon "'+n+'" can only be used if the item total amount is at least '+G(c)),ht();else if(p&&m<p)a?e.modal(t("<div>",{html:S.minQuantityWarning.replace("{0}",p)}),{autoFade:3e3,class:"warning small"}):console.log('Coupon "'+n+'" can only be used if there is at least '+p+" items in the cart!"),ht();else if(d){if(l>99||l<1)continue;(x=st())>l?(a?e.modal(t("<div>",{html:S.lowerThanCurrent.replace("{0}",x+"%")}),{autoFade:3e3,class:"warning small"}):console.log('Coupon "'+n+'" provides lower discount than current!'),ht()):(a&&e.modal(t("<div>",{html:S.couponAccepted.replace("{0}",l+"%")}),{autoFade:3e3,title:S.success,class:"success small"}),lt(l),v.data({amin:c,qmin:p}),ft(),ct())}else if(bt(n))a?e.modal(t("<div>",{html:S.reclaimed}),{autoFade:3e3,class:"warning small"}):console.log('Coupon "'+n+'" has been reclaimed previously.'),ht();else{var x=st(),C=x>0?h*x/100:0;h<l?(a?e.modal(t("<div>",{html:S.higherThanTotal.replace("{0}",G(l))}),{autoFade:3e3,class:"warning small"}):console.log('Coupon "'+n+'" provides higher discount that the total amount!'),ht()):C>l?(a?e.modal(t("<div>",{html:S.lowerThanCurrent.replace("{0}",G(C))}),{autoFade:3e3,class:"warning small"}):console.log('Coupon "'+n+'" offers less discount than the current!'),pt(l),v.data({amin:c,qmin:p}),ft(),ct()):(a&&e.modal(t("<div>",{html:S.couponAccepted.replace("{0}",G(l))}),{autoFade:3e3,title:S.success,class:"success small"}),pt(l),v.data({amin:c,qmin:p}),ft(),ct())}return!0}return e.modal(t("<div>",{html:S.noSuch}),{autoFade:3e3,class:"alert small"}),ht(),!1}return!0},xt=function(){var e=t("<form>",{class:"hidden",method:"post",action:(DEBUG?o.sandboxurl:o.url)+"cgi-bin/webscr"}).appendTo(r),n=r.find("."+_.item),i=function(a,n){e.append(t("<input>",{type:"hidden",name:a,val:n}))};if(n.length){if(o.sameWindowCheckout||e.attr("target",o.target),i("cmd","_cart"),i("charset","utf-8"),i("lc",o.locale),i("upload","1"),i("business",o.id.replace("|","@")),i("currency_code",o.currency),i("custom",N),o.hasOwnProperty("successUrl")&&i("return",o.successUrl.fixjAlbumPaths(o.resPath,o.rootPath,o.relPath)),o.hasOwnProperty("handling")&&o.handling>0&&i("handling_cart",o.handling),n.each(function(a){var e,n=function(t){var a,e,n={};return(a=t.find("."+_.title)).length&&(n.title=a.text()),(a=t.find("."+_.path)).length&&(n.path=a.val()),(a=t.find("."+_.file)).length&&(n.file=a.val()),(e=z(t))&&(e.hasOwnProperty("name")&&(n.option=e.name),e.hasOwnProperty("amount")&&(n.amount=e.amount),e.hasOwnProperty("shipping")&&(n.shipping=e.shipping),e.hasOwnProperty("shipping2")&&(n.shipping2=e.shipping2)),(a=t.find("."+_.quantity)).length&&(n.quantity=a.val()),(a=t.find("."+_.discount)).length&&(n.discount=Math.abs(parseInt(a.text(),10))),(a=t.find("."+_.tax)).length&&(n.tax=a.val()),n}(t(this)),s=String(a+1);e=[decodeURIComponent((o.sendAlbumName?M+"/":"")+n.path+n.file)],n.title===n.file||n.title.startsWith(n.file.stripExt())||e.push(n.title),t(this).find("select").length&&e.push(n.option),i("item_name_"+s,e.join(" :: ")),n.hasOwnProperty("discount")&&n.discount>0?i("amount_"+s,(n.amount*(1-n.discount/100)).toFixed(2)):i("amount_"+s,n.amount.toFixed(2)),n.hasOwnProperty("quantity")&&n.quantity>1&&i("quantity_"+s,n.quantity),n.hasOwnProperty("shipping")&&n.shipping>0&&(i("shipping_"+s,n.shipping),n.hasOwnProperty("shipping2")?n.shipping2>0&&i("shipping2_"+s,n.shipping2):i("shipping2_"+s,n.shipping)),n.hasOwnProperty("tax")&&n.tax>0&&i("tax_"+s,n.tax)}),e.append(t("<input>",{type:"submit",val:"PayPal"})),!f||wt(!1)){if(f){var s=y.data("val");if(s){var l=it(),d=v.data("amin"),p=tt(),c=v.data("qmin");(!d&&!c||!c&&l>=d||!d&&p>=c||l>=d&&p>=c)&&i("discount_rate_cart",s)}else(s=v.data("val"))&&(i("discount_amount_cart",s),g&&function(t){if(LOCALSTORAGE){var a=H(j);if(a&&a.length){if(!t||t==a||a.indexOf("::")&&a.match(new RegExp("^"+t+"::|::"+t+"::|::"+t+"$")))return;D(j,a+"::"+t)}else t&&D(j,t)}}(g.find("input").val()))}if(o.tax>0){var u=C.data("netval");u&&o.tax&&i("tax_cart",(u*o.tax/100).toFixed(2))}if(DEBUG&&console.log((e.html()+"").replace(/></g,">\n<")),!o.sameWindowCheckout){var h=Math.min(a.width()-80,1024),m=Math.min(a.height()-80,800);window.open("",o.target,"width="+h+",height="+m+",left=40,top=40,location=no,scrollbars=yes,resizable=yes,menubar=no,toolbar=no,directories=no,status=no,copyhistory=no")}e.trigger("submit"),o.shopAskPermissionToEmpty?Ct(Ot):(n.remove(),ct(),Ot())}}else buyNow.addClass("disabled")},Ct=function(a){e.modal(t("<h3>",{class:"text-center icon-warning",html:" "+S.removeAllItems}),[{t:S.yes,c:"alert icon-trash",h:function(){r.find(".item").remove(),ct(),Ot(),"function"==typeof a&&a.call(this)}},{t:S.no,h:function(){}}],{class:"alert small"})},Tt=function(){r.animate({scrollTop:r[0].scrollHeight-Math.round(r.outerHeight())},400)},Pt=function(t){l.is(":visible")||(e.addClass("no-scroll"),e.addClass("has-modal"),l.fadeIn(400,function(){Tt(),"function"==typeof t&&t.call(this)}))},Ot=function(a){tt();l.is(":visible")&&(t("body,html").removeClass("no-scroll"),t("body").removeClass("has-modal"),l.fadeOut(400,function(){"function"==typeof a&&a.call(this)}))};return o.hasOwnProperty("options")||(o.options=n.getRootProperty("shopOptionsGlobal")),"string"==typeof o.options&&(o.options=V(o.options)),function(a){void 0!==I&&(t(d).off("."+I),t("#cart_"+I).remove(),t("#cart_shortcut_"+I).remove()),F.data("lpp_ns",I="lpp_"+Math.floor(1e4*Math.random())),l=t("<div>",{id:"cart_"+I,class:"modal "+_.cart,role:"modal"}).hide().appendTo(e),q=t("<div>",{id:"cart_shortcut_"+I,class:o.useShortcutButton?_.shortcut:"buttons"}).append(t("<a>",{class:"secondary button view-cart",html:" "+S.view}).on("click."+I,function(){Pt()})).append(t("<a>",{class:"global button disabled add-cart icon-shopping-cart-add",html:" "+S.addCart}).on("click."+I,function(){"function"==typeof o.getSelected&&(Z(o.getSelected.call()),"function"==typeof o.selectNone&&o.selectNone.call())})).appendTo(F),(d=t("<div>",{class:"window has-header "+_.window,role:"dialog"}).appendTo(l)).append(t("<header>",{class:"icon-shopping-cart",html:" <strong> "+S.shoppingCart+"</strong>"})),d.append(t("<a>",{class:"btn close"}).on("click."+I,Ot)),l.on("click."+I,function(t){return t.target.id!=="cart_"+I||(Ot(),!1)}),r=t("<div>",{class:"content"}).appendTo(d),(p=t("<div>",{class:_.summary+" clearfix"}).hide().appendTo(r)).append(t("<div>",{class:_.summaryTxt})),p.append(t("<a>",{class:"details-btn icon-caret-down",text:" "+S.edit}).on("click."+I,et)),c=t("<div>",{class:_.details+" "+_.items}).hide().appendTo(r),u=t("<div>",{class:_.newItems+" "+_.items}).appendTo(r);var n=t("<div>",{class:_.pricing}).appendTo(r);if(h=t("<div>",{class:_.itemTotal,text:S.subtotal+": "}).appendTo(n),m=t("<span>",{class:_.itemTotalAmount+" "+_.amount}).appendTo(h),o.coupons||o.discount){if(f=t("<div>",{class:_.reduction+" clearfix"}).appendTo(n),o.coupons){var i=t("<form>",{class:_.coupon}).appendTo(f);i.append(t("<a>",{class:"button icon-close"}).on("click."+I,function(){mt(),ct()})),g=t("<input>",{type:"text",placeholder:S.couponCode}).appendTo(i),i.append(t("<a>",{class:"secondary button icon-refresh"}).on("click",function(){wt(!0)})),i.on("submit",function(){return wt(!0),!1}),g.on("blur",function(){wt(!0)}),g.prev().addTooltip(S.remove)}f.append(t("<div>",{class:_.data,text:S.discount}).append(y=t("<span>",{class:_.discount+" "+_.discountRate})).append(": &ndash;").append(v=t("<span>",{class:_.discountAmount+" "+_.amount})))}b=t("<div>",{class:_.shipping,text:S.shippingAndHandling+": +"}).appendTo(n),w=t("<span>",{class:_.shippingAmount+" "+_.amount}).appendTo(b),o.tax&&(T=t("<div>",{class:_.tax,text:S.tax+" ("+o.tax+"%): +"}).appendTo(n),P=t("<span>",{class:_.taxAmount+" "+_.amount}).appendTo(T)),x=t("<div>",{class:_.total,text:S.total+": "}).appendTo(n),C=t("<span>",{class:_.totalAmount+" "+_.amount}).appendTo(x);var s=t("<div>",{class:_.buttons}).appendTo(r);s.append(t("<a>",{class:"secondary button icon-arrow-left",text:" "+S.continueShopping}).on("click."+I,Ot)),A=t("<a>",{class:"alert button icon-trash",text:" "+S.emptyCart}).on("click."+I,Ct).appendTo(s),O=t("<a>",{class:"disabled button icon-paypal",html:" "+S.buyNow}).on("click."+I,xt).appendTo(s),s.after(t("<p>",{class:"fineprint",text:S.processedByPaypal})),o.hasOwnProperty("instructions")&&r.append(t("<div>",{class:"instructions icon-info"}).append(t("<div>").append(o.instructions.fixjAlbumPaths(o.resPath,o.rootPath,o.relPath)))),rt(),d.find("a.close").addTooltip(S.continueShopping),Q()}(),F.on("addItems",function(t){var a=Array.prototype.slice.call(arguments,1);Z(a)}).on("emptyCart",function(t,a){Ct(a)}).on("itemsSelected",function(a,e){!function(a){var e=q.find(".global.add-cart");if(a){var n=e.children(".badge");n.length||(n=t("<span>",{class:"badge red"}).appendTo(e)),n.text(a).show(),e.removeClass("disabled"),e.addTooltip(S.addSelectedItems)}else e.addClass("disabled").children(".badge").hide(),e.addTooltip(S.selectItems)}(e)}).on("showCart",function(t,a){Pt(a)}).on("hideCart",function(t,a){Ot(a)}),o.hasOwnProperty("onReady")&&o.onReady(this),this},t.fn.paypal.defaults={currency:"EUR",locale:"US",quantityCap:0,expiry:36e5,shippingFlat:!1,selectMethod:"combo",sameWindowCheckout:!1,sendAlbumName:!1,shopAskPermissionToEmpty:!1,useShortcutButton:!1,target:"BuyNow",rootPath:"",relPath:"",thumbsFolder:"thumbs/",url:"https://www.paypal.com/",sandboxurl:"https://www.sandbox.paypal.com/"},t.fn.paypal.text=getTranslations({addCart:"Add to Cart",shoppingCart:"Shopping cart",edit:"Edit",continueShopping:"Continue shopping",buyNow:"Buy Now",closeWindow:"Close window",view:"View",selectItems:"Select items to add!",addSelectedItems:"Add selected items!",emptyCart:"Empty Cart",removeAllItems:"Remove all items?",yes:"Yes",no:"No",noMoreItems:"Can't add more than 99 items at once at PayPal.",processedByPaypal:"Payment processed by PayPal",item:"item",items:"items",success:"Success",couponCode:"Coupon code",redeem:"Redeem",noSuch:"No such coupon exists!",expired:"The coupon code <b>{0}</b> has expired!",lowerThanCurrent:"This coupon offers lower discount than the current <b>{0}</b>.",reclaimed:"This coupon has already been used!",subtotal:"Subtotal",shippingAndHandling:"Shipping and handling",reduction:"Reduction",discount:"Discount",total:"Total",tax:"Tax",remove:"Remove",couponAccepted:"Coupon code accepted, discounting <b>{0}</b>.",couponRemoved:"Coupon has been removed.",amountLowerThan:"The amount is lower than the discount <b>{0}</b>.",addMoreItems:"Add {0} more item(s) to use this coupon!",validAbove:"Valid only above {0} cart value.",higherThanTotal:"Coupon provides higher discount (<b>{0}</b>) than the cart total.",minAmountWarning:"This coupon can only be used if the total amount exceeds <b>{0}</b>.",minQuantityWarning:"This coupon can only be used if the number of items exceeds <b>{0}</b>.",maxNItems:"Maximum <b>{0}</b> items allowed!"})}(jQuery,$(window),$("body"));