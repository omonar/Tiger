!function(e){"use strict";e.fn.audioPlayer=function(t){e(this).data("audioplayer")&&(t=e.extend({},t,e(this).data("audioplayer"))),(t=e.extend({},e.fn.audioPlayer.defaults,t)).hasOwnProperty("rootPath")&&"."!==t.rootPath||(t.rootPath="");var a="lap_ns",o=(t.rootPath?t.rootPath+"/":"")+t.folder+"/";return this.each(function(){var n,r,s,u=e(this),i=e(),l=e(),p=e(),d=e(),c=e(),f=0,m=t.volume,v=!1,h=function(t){if(typeof t!==UNDEF&&typeof t!==e.event||(t=f),c.attr("src")&&t===f){if(!d[0].paused)return}else!function(e){d[0].pause(),(e>=n.length||e<0)&&(e%=n.length),c.attr({src:o+n[e]}),d[0].load(),f=e,p.children().removeClass("active"),p.children().eq(e).addClass("active")}(t);(r=d[0].play())&&r.then(function(){u.addClass("active"),u.data("paused",!1)},function(e){u.removeClass("active"),u.data("paused",!0),console.log("Autoplay has been prevented by the browser. Interact with the page first!")})},y=function(){clearTimeout(s);var e=d[0].volume;if("number"==typeof e||"number"==typeof(e=parseFloat(e))){if((e=Math.min(e+t.step,1))>=m)return d[0].volume=m,void setTimeout(function(){v=!1},50);d[0].volume=e,s=setTimeout(y,t.stepFreq)}},T=function(){d[0].paused&&(d[0].volume=.01,h()),v=!0,s=setTimeout(y,t.stepFreq),u.data("paused",!1)},P=function(){clearTimeout(s);var e=d[0].volume;if("number"==typeof e||"number"==typeof(e=parseFloat(e))){if((e=Math.max(e-t.step,0))<.01)return d[0].volume=0,F(),void setTimeout(function(){v=!1},50);d[0].volume=e,s=setTimeout(P,t.stepFreq)}},g=function(){d[0].paused||(v=!0,s=setTimeout(P,t.stepFreq)),u.data("paused",!0)},k=function(){f>=n.length-1?t.loop&&h(0):h(f+1)},F=function(){d[0].pause(),r=null,u.removeClass("active"),u.data("paused",!0)},C=function(){e.cookie&&e.cookie("ap-status",(d[0].paused?"0":"1")+"::"+(d[0].currentTime||0)+"::"+(v||d[0].paused?m:d[0].volume)+(f?"::"+f:""))};if(i=e("#"+u.data("rel")),u.data("src"))n=u.data("src").split("::");else{if(!t.hasOwnProperty("src"))return;n="string"==typeof t.src?t.src.split("::"):t.src}t.saveStatus&&function(){if(e.cookie){var a=e.cookie("ap-status");a&&(a=a.split("::"),t.autoPlay="1"===a[0],t.startTime=parseFloat(a[1]||0,10),m=t.volume=parseFloat(a[2])||.2,((f=parseInt(a[3]||0,10))<0||f>n.length)&&(f=0))}}(),function(){if(l=e("<div>",{class:t.playerHook}),(d=e("<audio>",{preload:"auto",controls:!0,controlsList:"nofullscreen nodownload noremote"}).appendTo(l))[0].pause(),u.data("paused",!0),c=e("<source>",{src:o+n[f]}).appendTo(d),setTimeout(function(){d.on("ended."+a,function(){return k(),!0}),d.on("pause."+a,function(){u.data("paused",!0),u.removeClass("active")}),d.on("playing."+a,function(){u.data("paused",!1),0===d[0].volume&&(d[0].volume=m||t.volume),u.addClass("active")}),d.on("volumechange."+a,function(){v||(clearTimeout(s),m=d[0].volume)})},100),n.length){p=e("<ul>",{class:t.playListHook}).appendTo(l);for(var r=0;r<n.length;r++)p.append(e("<li>").append(e("<a>",{text:decodeURIComponent(n[r].replace(/\.[^\.]*$/,""))}).on("click."+a,function(t){var a=p.children().index(e(t.target).parent());return h(a),!1})));p.children().eq(f).addClass("active")}}(),i.length?i.append(l):u.addTooltip(l,{pos:t.pos}),u.on("click."+a,function(){return!(!i.length||i.is(":hidden"))||(u.data("paused")?T():g(),!1)}),u.on("removePlayer."+a,function(){l.trigger("removeTooltip"),l.add(u).off("."+a),l.remove()}),u.on("pausePlayer."+a,F),u.on("startPlayer."+a,h),u.on("fadeInPlayer."+a,T),u.on("fadeOutPlayer."+a,g),setTimeout(function(){d[0].volume=t.volume,t.hasOwnProperty("startTime")&&(d[0].currentTime=t.startTime),t.autoPlay&&T(),e(window).on("unload."+a,C)},50)})},e.fn.audioPlayer.defaults={autoPlay:!0,loop:!0,volume:.2,stepFreq:30,step:.02,saveStatus:!0,playerHook:"player",playListHook:"play-list",folder:"res",rootPath:"",pos:[1,2,1,0]}}(jQuery);