!function(e){"use strict";e.fn.audioPlayer=function(t){e(this).data("audioplayer")&&(t=e.extend({},t,e(this).data("audioplayer")));var a="lap_ns",o=("."===(t=e.extend({},e.fn.audioPlayer.defaults,t)).rootPath?"":t.rootPath+"/")+t.folder+"/";return this.each(function(){var n,u,r,s=e(this),i=e(),l=e(),p=e(),d=e(),c=0,f=t.volume,m=!1,v=function(t){if(typeof t!==UNDEF&&typeof t!==e.event||(t=c),d.attr("src")&&t===c){if(!p[0].paused)return}else!function(e){p[0].pause(),(e>=n.length||e<0)&&(e%=n.length),d.attr({src:o+n[e]}),p[0].load(),c=e,l.children().removeClass("active"),l.children().eq(e).addClass("active")}(t);(u=p[0].play())&&u.then(function(){s.addClass("active"),s.data("paused",!1)},function(e){s.removeClass("active"),s.data("paused",!0),console.log("Autoplay has been prevented by the browser. Interact with the page first!")})},y=function(){clearTimeout(r);var e=p[0].volume;if("number"==typeof e||"number"==typeof(e=parseFloat(e))){if((e=Math.min(e+t.step,1))>=f)return p[0].volume=f,void setTimeout(function(){m=!1},50);p[0].volume=e,r=setTimeout(y,t.stepFreq)}},h=function(){p[0].paused&&(p[0].volume=.01,v()),m=!0,r=setTimeout(y,t.stepFreq),s.data("paused",!1)},T=function(){clearTimeout(r);var e=p[0].volume;if("number"==typeof e||"number"==typeof(e=parseFloat(e))){if((e=Math.max(e-t.step,0))<.01)return p[0].volume=0,k(),void setTimeout(function(){m=!1},50);p[0].volume=e,r=setTimeout(T,t.stepFreq)}},P=function(){p[0].paused||(m=!0,r=setTimeout(T,t.stepFreq)),s.data("paused",!0)},g=function(){c>=n.length-1?t.loop&&v(0):v(c+1)},k=function(){p[0].pause(),u=null,s.removeClass("active"),s.data("paused",!0)},F=function(){e.cookie&&e.cookie("ap-status",(p[0].paused?"0":"1")+"::"+(p[0].currentTime||0)+"::"+(m||p[0].paused?f:p[0].volume)+(c?"::"+c:""))};if(s.data("src"))n=s.data("src").split("::");else{if(!t.hasOwnProperty("src"))return;n="string"==typeof t.src?t.src.split("::"):t.src}t.saveStatus&&function(){if(e.cookie){var a=e.cookie("ap-status");a&&(a=a.split("::"),t.autoPlay="1"===a[0],t.startTime=parseFloat(a[1]||0,10),f=t.volume=parseFloat(a[2])||.2,((c=parseInt(a[3]||0,10))<0||c>n.length)&&(c=0))}}(),function(){if(i=e("<div>",{class:t.playerHook}),(p=e("<audio>",{preload:"auto",controls:!0,controlsList:"nofullscreen nodownload noremote"}).appendTo(i))[0].pause(),s.data("paused",!0),d=e("<source>",{src:o+n[c]}).appendTo(p),setTimeout(function(){p.on("ended."+a,function(){return g(),!0}),p.on("pause."+a,function(){s.data("paused",!0),s.removeClass("active")}),p.on("playing."+a,function(){s.data("paused",!1),0===p[0].volume&&(p[0].volume=f||t.volume),s.addClass("active")}),p.on("volumechange."+a,function(){m||(clearTimeout(r),f=p[0].volume)})},100),n.length){l=e("<ul>",{class:t.playListHook}).appendTo(i);for(var u=0;u<n.length;u++)l.append(e("<li>").append(e("<a>",{text:decodeURIComponent(n[u].replace(/\.[^\.]*$/,""))}).on("click."+a,function(t){var a=l.children().index(e(t.target).parent());return v(a),!1})));l.children().eq(c).addClass("active")}}(),s.addTooltip(i),s.on("click."+a,function(){return s.data("paused")?h():P(),!1}),s.on("removePlayer."+a,function(){i.trigger("removeTooltip"),i.add(s).off("."+a),i.remove()}),s.on("pausePlayer."+a,k),s.on("startPlayer."+a,v),s.on("fadeInPlayer."+a,h),s.on("fadeOutPlayer."+a,P),setTimeout(function(){p[0].volume=t.volume,t.hasOwnProperty("startTime")&&(p[0].currentTime=t.startTime),t.autoPlay&&h(),e(window).on("unload."+a,F)},50)})},e.fn.audioPlayer.defaults={autoPlay:!0,loop:!0,volume:.2,stepFreq:30,step:.02,saveStatus:!0,playerHook:"player",playListHook:"play-list",folder:"res",rootPath:"."}}(jQuery);