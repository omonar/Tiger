!function(e,n,t,o){"use strict";e.fn.addMap=function(n){return n=e.extend({},e.fn.addMap.defaults,n),this.each(function(){var o=e(this);if(typeof o.data("map-ns")===UNDEF){var a,r,l=e.extend({},n,readData(o,"location,type,zoom,label,markers,current")),i=[],s=-1,p=!1,m=function(e){e.setAnimation(google.maps.Animation.BOUNCE),a.setCenter(e.getPosition())},g=function(e,n){return!(typeof n!==UNDEF&&(s>=0&&(i[s].setAnimation(null),s=-1),"number"!=typeof n&&(n=function(e){for(var n=0;n<i.length;n++)if(i[n].link===e)return n;return-1}(n)),n>=0&&n<i.length))||(m(i[n]),s=n,!1)},d=function(){p||(c(),-1!==s&&a.setCenter(i[s].getPosition()))},c=function(){o.is(":visible")&&l.fitBounds&&r&&(a.fitBounds(r),a.panToBounds(r),p=!0)},f=function(){i&&i.length&&(s>=0&&(null!==i[s].getAnimation()&&i[s].setAnimation(null),s=-1),r&&c())},u=function(){i&&i.length&&(s>=0&&(null!==i[s].getAnimation()&&i[s].setAnimation(null),s=-1),m(this)),typeof l.onMarkerClick===FUNCTION&&l.onMarkerClick.call(this)},h=function(e){var n=function(e){typeof e===FUNCTION&&e.call(null),typeof l.onReady===FUNCTION&&l.onReady.call(this)};if("undefined"!=typeof google&&google.maps)n(e);else{var o=t.createElement("script");o.type="text/javascript",o.src=l.apiUrl+"?key="+(l.apiKey||""),o.onload=function(){setTimeout(n,100,typeof e===FUNCTION?e:null)},t.body.appendChild(o)}},k=function(e,n){if(!o.data("rendered")){var t,s=function(e){e<l.markers.length?(l.markers[e].hasOwnProperty("latLng")&&(i[e]=new google.maps.Marker({map:a,position:l.markers[e].latLng,animation:google.maps.Animation.DROP}),l.markers[e].hasOwnProperty("title")&&i[e].setTitle(l.markers[e].title),l.markers[e].hasOwnProperty("link")&&(i[e].link=l.markers[e].link,google.maps.event.addListener(i[e],"click",u))),setTimeout(s,t,e+1)):l.markers.length>1&&c()};if(l.hasOwnProperty("markers"))for(m=0;m<l.markers.length;m++)l.markers[m].hasOwnProperty("pos")&&!l.markers[m].hasOwnProperty("latLng")&&(p=l.markers[m].pos.split(","),l.markers[m].latLng={lat:parseFloat(p[0]),lng:parseFloat(p[1])});else if(l.hasOwnProperty("location")){var p=l.location.split(",");l.markers=[{latLng:{lat:parseFloat(p[0]),lng:parseFloat(p[1])}}]}else console.log("Error: initializing Map with no location!"),l.markers=[{latLng:{lat:0,lng:0}}];if(t=Math.minMax(10,Math.round(1e3/l.markers.length),100),l.markers.length>1){r=new google.maps.LatLngBounds;for(var m=0;m<l.markers.length;m++)r.extend(l.markers[m].latLng)}a=new google.maps.Map(o[0],{mapTypeId:l.type,fullscreenControl:l.fullscreenControl,scrollwheel:l.enableScrollWheel,panControl:!1,controlSize:32}),l.markers.length<=1&&(a.setCenter(l.markers[0].latLng),a.setZoom(l.zoom)),s(0),typeof l.onTypeChanged===FUNCTION&&google.maps.event.addListener(a,"maptypeid_changed",function(){l.onTypeChanged.call(a.getMapTypeId())}),typeof l.onZoomChanged===FUNCTION&&google.maps.event.addListener(a,"zoom_changed",function(){l.onZoomChanged.call(a.getZoom())}),o.data("rendered",!0),o.on("setActive",g),o.on("resetMarkers",f),o.on("refresh",d),typeof n===FUNCTION&&n.call(null)}};l.autoLoad?h(k):h(),o.on("render",k)}})},e.fn.addMap.defaults={apiUrl:"https://maps.googleapis.com/maps/api/js",zoom:16,fitBounds:!0,type:"roadmap",fullscreenControl:!1,enableScrollWheel:!1,autoLoad:!0}}(jQuery,window,document);